{% extends "base.html" %}

{% macro chart(name, legend) %}
	<div class="chartbox">
		<div id="{{ name }}" class="chart"></div>
		<div class="legend">
		{% for color, label in legend %}
			<span style="color: {{ color }};">&#9473;</span>&nbsp;{{ label }}
		{% endfor %}
		</div>
	</div>
{% endmacro %}

{% block container %}
<style type="text/css">
	.chart {
		width: 100%;
		height: 300px;
		display: table-cell;
	}
	.chartbox {
		display: table;
	}
	.legend {
		display: table-cell;
		vertical-align: middle;
		padding: 20px 10px 30px 0;
	}
</style>
<!-- this has to be in body for some odd reason -->
<script src="{{ url_for('static', filename='js/raphael.js') }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ url_for('static', filename='js/ico.min.js') }}" type="text/javascript" charset="utf-8"></script>
<div class="page-header">
	<h1>Charts</h1>
</div>

<h2>Temperature</h2>
{{ chart('tempchart', [
	('#000099', 'CPU'),
	('#990000', 'Indoor'),
	('#009900', 'Outdoor')
])
}}

<h2>Load</h2>
{{ chart('loadchart', [('#000099', 'CPU')]) }}

<h2>Memory</h2>
{{ chart('memchart', [
	('#000099', 'RAM'),
	('#990099', 'SWAP')
])
}}

<script type="text/javascript">
	new Ico.LineGraph(document.getElementById('tempchart'), {
			blue: {{ temperatures.cpu|tojson }},
			red: {{ temperatures.indoor|tojson }},
			green: {{ temperatures.outdoor|tojson }}
		},
		{
			markers: 'circle',
			colours: { red: '#990000', green: '#009900', blue: '#000099'},
			labels: {{ temperatures.date|tojson|safe }},
			grid: true
		}
	);
	new Ico.LineGraph(document.getElementById('loadchart'), {
			blue: {{ loads.cpu|tojson }}
		},
		{
			markers: 'circle',
			colours: { red: '#990000', green: '#009900', blue: '#000099'},
			labels: {{ loads.date|tojson|safe }},
			grid: true,
			label_count: 10,
			label_step: 10
		}
	);
	new Ico.LineGraph(document.getElementById('memchart'), {
			blue: {{ mems.ram|tojson }},
			red: {{ mems.swap|tojson }}
		},
		{
			markers: 'circle',
			colours: { red: '#990000', green: '#009900', blue: '#000099'},
			labels: {{ mems.date|tojson|safe }},
			grid: true
		}
	);
</script>
{% endblock %}
